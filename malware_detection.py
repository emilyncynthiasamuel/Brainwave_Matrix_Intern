import os
import yara
rules = """
rule simple_malware_detection {
    strings:
        $a = "<script>alert('Malware!');</script>" 
        $b = {6A 40 68 00 30 00 00 6A 14 8D 91}
    condition:
        $a or $b
}
"""
rule_compiler = yara.compile(source=rules)
scan_directory = 'C:\\Users\\HP\\Downloads\\Brainwave_Matrix_Intern'  
def scan_files(directory):
    for root, _, files in os.walk(directory):
        for file in files:
            file_path = os.path.join(root, file)
            try:
                matches = rule_compiler.match(file_path)
                if matches:
                    print(f'Malware detected in: {file_path}')
            except Exception as e:
                print(f'Error scanning {file_path}: {e}')
if __name__ == "__main__":
    print("Malware Detection Script Started...")
    scan_files(scan_directory)
